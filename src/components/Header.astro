---
// src/components/Header.astro
// KODE FINAL DENGAN STRUKTUR HTML YANG BENAR

import { headerMenu } from '@data/menu';
import Logo from '@components/Logo.astro';
import { Menu, X } from 'lucide-astro';
import Button from '@components/ui/Button.astro';

const ctaButton = {
    name: 'Hubungi Kami',
    link: '/contact-us',
};

const currentPath = Astro.url.pathname;

const isCurrentPage = (link: string) => {
    if (link === '/') return currentPath === '/';
    return currentPath.startsWith(link);
};
---

<!-- =================================================================== -->
<!-- === PERUBAHAN STRUKTUR UTAMA ADA DI SINI === -->

<!-- Tombol Hamburger sekarang ada di luar, di level paling atas -->
<button
    id="mobile-menu-button"
    class="fixed top-8 right-8 z-[60] p-2 border-none cursor-pointer bg-transparent lg:hidden"
    aria-label="Toggle Menu"
    aria-expanded="false"
>
    <span class="menu-icon block">
        <Menu size={24} class="text-body-base" />
    </span>
    <span class="close-icon hidden">
        <X size={24} class="text-white" />
    </span>
</button>

<!-- Header utama -->
<header class="fixed top-0 z-50 w-screen left-0">
    <div class="site-container mx-auto px-4 mt-4">
        <div id="header-inner" class="flex justify-between items-center bg-white h-20 rounded-lg p-4 border-black border transition-all duration-300">
            <Logo />
            <nav class="hidden lg:flex items-center gap-8" aria-label="Site Navigation">
                <ul class="flex gap-8 items-center">
                    {headerMenu.map((item) => (
                        <li>
                            <a
                                href={item.link}
                                class:list={[
                                    'text-small font-medium',
                                    isCurrentPage(item.link)
                                        ? 'text-nav-text-current font-semibold'
                                        : 'text-nav-text hover:text-nav-text-hover',
                                ]}
                                aria-current={isCurrentPage(item.link) ? 'page' : undefined}
                            >
                                {item.name}
                            </a>
                        </li>
                    ))}
                </ul>
                <Button href={ctaButton.link} variant="primary">{ctaButton.name}</Button>
            </nav>
        </div>
    </div>
</header>

<!-- =================================================================== -->

<!-- Script HANYA untuk efek scroll, logika menu dipindah total -->
<script>
    const topClasses = ['bg-white', 'border-black'];
    const scrolledClasses = ['bg-white/80', 'backdrop-blur-sm', 'border-black/10', 'shadow-lg'];
    const headerInner = document.getElementById('header-inner');
    
    const handleScroll = () => { 
        if (!headerInner) return; 
        if (window.scrollY > 10) { 
            headerInner.classList.remove(...topClasses); 
            headerInner.classList.add(...scrolledClasses); 
        } else { 
            headerInner.classList.remove(...scrolledClasses); 
            headerInner.classList.add(...topClasses); 
        } 
    };
    
    document.addEventListener('DOMContentLoaded', handleScroll);
    document.addEventListener('scroll', handleScroll, { passive: true });
</script>
